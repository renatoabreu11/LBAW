$(document).ready(function(){function e(e,o){$.magnificPopup.close();let i;(i=$.ajax({type:"POST",url:BASE_URL+"api/user/delete_notification.php",data:{id:e,token:token,userId:userId},dataType:"json"})).done(function(e,i,t){let s=e.message;e.response.includes("Success")?1===(n=$(".notificationsPage .notifications-wrapper")).length?window.location.reload(!0):o.hide("slow",function(){o.remove()}):$.magnificPopup.open({items:{src:'<div class="white-popup">'+s+"</div>",type:"inline",mainClass:"mfp-fade"}})}),i.fail(function(e,o,i){console.error("The following error occurred: "+o,i)})}function o(e){$.magnificPopup.close();let o=$("#reportUserMessage").val(),i=$(e).find("input[name=reportedUserId]").val(),n=$.ajax({type:"POST",url:BASE_URL+"api/user/report_user.php",data:{reportedUserId:i,comment:o,userId:userId,token:token},dataType:"json"});n.done(function(o,i,n){let t=o.message;o.response.includes("Success")&&$(e).trigger("reset"),$.magnificPopup.open({items:{src:'<div class="white-popup">'+t+"</div>",type:"inline",mainClass:"mfp-fade"}})}),n.fail(function(e,o,i){console.error("The following error occurred: "+o+": "+i)})}if($(window).width()<=768){let e=$("#wins");e.find(".win-wrapper").removeClass("col-lg-3").removeClass("col-md-3"),e.find(".win-wrapper #win-info-image").addClass("col-sm-6"),e.find(".win-wrapper #win-info-text").addClass("col-sm-6"),e.find(".win-info").removeClass("text-right").addClass("text-center"),e.find(".win-image").width(156)}$(".clock").each(function(){let e=$(this).find("p").text();$(this).countdown(e).on("update.countdown",function(e){let o="%Hh:%Mm:%Ss";e.offset.totalDays>0&&(o="%-d day%!d "+o),e.offset.weeks>0&&(o="%-w week%!w "+o),$(this).html(e.strftime(o))}).on("finish.countdown",function(e){$(this).html("This offer has expired!").parent().addClass("disabled")})});let i=document.location.hash;i&&$('.nav-tabs a[href="'+i+'"]').tab("show"),$(".nav-tabs a").on("shown.bs.tab",function(e){window.location.hash=e.target.hash}),$("#follow-btn").click(function(){let e,o=$("#details").find(".details-short-info-member-number").text();"Follow"===$(this).text()?((e=$.ajax({type:"POST",url:BASE_URL+"api/user/follow.php",data:{followedUserId:o,userId:userId,token:token},dataType:"json"})).done(function(e,o,i){e.message;e.response.includes("Success")&&$("#follow-btn").html("Unfollow")}),e.fail(function(e,o,i){console.error("The following error occurred: "+o+": "+i)})):((e=$.ajax({type:"POST",url:BASE_URL+"api/user/unfollow.php",data:{unfollowedUserId:o,userId:userId,token:token},dataType:"json"})).done(function(e,o,i){e.message;e.response.includes("Success")&&$("#follow-btn").html("Follow")}),e.fail(function(e,o,i){console.error("The following error occurred: "+o+": "+i)}))}),$("#following").find(".btn").click(function(){let e=$(this).parent().prev().children("a").eq(0).attr("href"),o=e.lastIndexOf("id="),i=e.substring(o+3),n=$(this).parent().parent(),t=$.ajax({type:"POST",url:BASE_URL+"api/user/unfollow.php",data:{unfollowedUserId:i,userId:userId,token:token},dataType:"json"});t.done(function(e,o,i){e.message;e.response.includes("Success")&&n.fadeOut(500,function(){n.remove();let e=$(".following-badge"),o=e.html();e.html(parseInt(o,10)-1);let i=$("#following");0===i.children().length&&i.html("<p>No users being followed.</p>")})}),t.fail(function(e,o,i){console.error("The following error occurred: "+o+": "+i)})}),$("#wins").find(".win-review-rating-stars .glyphicon").mouseover(function(){$(this).removeClass("glyphicon-star-empty").addClass("glyphicon-star"),$(this).prevAll().removeClass("glyphicon-star-empty").addClass("glyphicon-star"),$(this).nextAll().removeClass("glyphicon-star").addClass("glyphicon-star-empty")}),$(".btn-review-submit").click(function(){let e=$(this).prev().prev().children(".win-review-rating-stars").children(".glyphicon-star").length,o=$(this).prev().children("textarea").val(),i=$(this).prev().prev().prev().val(),n=$(this).parent().parent(),t=$.ajax({type:"POST",url:BASE_URL+"api/user/review_auction.php",data:{rating:e,message:o,bidId:i,userId:userId,token:token},dataType:"json"});t.done(function(e,o,i){e.message;e.response.includes("Success")&&n.fadeOut(500,function(){n.remove()})}),t.fail(function(e,o,i){console.error("The following error occurred: "+o+": "+i)})}),$(".closePopup").on("click",function(){$.magnificPopup.close()});let n=$(".notificationsPage .notifications-wrapper");n.on("click",".readNotification",function(){let e=$(this).attr("class").split("id-");if(2===e.length){let o=$(this).closest(".notifications-wrapper"),i=e[1],n=$.ajax({type:"POST",url:BASE_URL+"api/user/read_notification.php",data:{notification:i,token:token,userId:userId},dataType:"json"});n.done(function(e,i,n){let t=e.message;e.response.includes("Success")?($('<a href="#" data-toggle="tooltip" title="Notification read!"><i class="fa fa-eye" aria-hidden="true"></i></a>').insertAfter(o.find(".media-body small")),o.find("span a.readNotification").remove()):$.magnificPopup.open({items:{src:'<div class="white-popup">'+t+"</div>",type:"inline",mainClass:"mfp-fade"}})})}}),n.on("click",".removeNotificationPopup",function(){let o=$(this).attr("class").split("id-");if(2===o.length){let i=$(this).closest(".notifications-wrapper"),n=o[1];$(".removeNotificationPopup").magnificPopup({type:"inline",midClick:!0,mainClass:"mfp-fade"}).magnificPopup("open"),$(".removeNotification").off(),$(".removeNotification").one("click",function(){$.magnificPopup.close(),e(n,i)})}}),$(".reportUserPopup").magnificPopup({type:"inline",midClick:!0,mainClass:"mfp-fade"}),$("#reportUserForm").validate({rules:{reportUserMessage:{required:!0,maxlength:512}},submitHandler:o})});