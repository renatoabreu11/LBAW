$(document).ready(function(){function e(e,i){$.magnificPopup.close();let n;(n=$.ajax({type:"POST",url:BASE_URL+"api/user/delete_notification.php",data:{id:e,token:token,userId:userId},dataType:"json"})).done(function(e,n,t){let s=e.message;e.response.includes("Success")?1===(o=$(".notificationsPage .notifications-wrapper")).length?window.location.reload(!0):i.hide("slow",function(){i.remove()}):$.magnificPopup.open({items:{src:'<div class="white-popup">'+s+"</div>",type:"inline",mainClass:"mfp-fade"}})}),n.fail(function(e,i,n){console.error("The following error occurred: "+i,n)})}function i(e){$.magnificPopup.close();let i=$("#reportUserMessage").val(),n=$(e).find("input[name=reportedUserId]").val(),o=$.ajax({type:"POST",url:BASE_URL+"api/user/report_user.php",data:{reportedUserId:n,comment:i,userId:userId,token:token},dataType:"json"});o.done(function(i,n,o){let t=i.message;i.response.includes("Success")&&$(e).trigger("reset"),$.magnificPopup.open({items:{src:'<div class="white-popup">'+t+"</div>",type:"inline",mainClass:"mfp-fade"}})}),o.fail(function(e,i,n){console.error("The following error occurred: "+i+": "+n)})}if($(window).width()<=768){let e=$("#wins");e.find(".win-wrapper").removeClass("col-lg-3").removeClass("col-md-3"),e.find(".win-wrapper #win-info-image").addClass("col-sm-6"),e.find(".win-wrapper #win-info-text").addClass("col-sm-6"),e.find(".win-info").removeClass("text-right").addClass("text-center"),e.find(".win-image").width(156)}$(".clock").each(function(){let e=$(this).find("p").text();$(this).countdown(e).on("update.countdown",function(e){let i="%Hh:%Mm:%Ss";e.offset.totalDays>0&&(i="%-d day%!d "+i),e.offset.weeks>0&&(i="%-w week%!w "+i),$(this).html(e.strftime(i))}).on("finish.countdown",function(e){$(this).html("This offer has expired!").parent().addClass("disabled")})});let n=document.location.hash;n&&$('.nav-tabs a[href="'+n+'"]').tab("show"),$(".nav-tabs a").on("shown.bs.tab",function(e){window.location.hash=e.target.hash}),$("#follow-btn").click(function(){let e,i=$("#details").find(".details-short-info-member-number").text();"Follow"===$(this).text()?((e=$.ajax({type:"POST",url:BASE_URL+"api/user/follow.php",data:{followedUserId:i,userId:userId,token:token},dataType:"json"})).done(function(e,i,n){e.message;e.response.includes("Success")&&$("#follow-btn").html("Unfollow")}),e.fail(function(e,i,n){console.error("The following error occurred: "+i+": "+n)})):((e=$.ajax({type:"POST",url:BASE_URL+"api/user/unfollow.php",data:{unfollowedUserId:i,userId:userId,token:token},dataType:"json"})).done(function(e,i,n){e.message;e.response.includes("Success")&&$("#follow-btn").html("Follow")}),e.fail(function(e,i,n){console.error("The following error occurred: "+i+": "+n)}))}),$("#following").find(".btn").click(function(){let e=$(this).parent().prev().children("a").eq(0).attr("href"),i=e.lastIndexOf("id="),n=e.substring(i+3),o=$(this).parent().parent(),t=$.ajax({type:"POST",url:BASE_URL+"api/user/unfollow.php",data:{unfollowedUserId:n,userId:userId,token:token},dataType:"json"});t.done(function(e,i,n){e.message;e.response.includes("Success")&&o.fadeOut(500,function(){o.remove();let e=$(".following-badge"),i=e.html();e.html(parseInt(i,10)-1);let n=$("#following");0===n.children().length&&n.html("<p>No users being followed.</p>")})}),t.fail(function(e,i,n){console.error("The following error occurred: "+i+": "+n)})}),$("#wins").find(".win-review-rating-stars .glyphicon").mouseover(function(){$(this).removeClass("glyphicon-star-empty").addClass("glyphicon-star"),$(this).prevAll().removeClass("glyphicon-star-empty").addClass("glyphicon-star"),$(this).nextAll().removeClass("glyphicon-star").addClass("glyphicon-star-empty")}),$(".btn-review-submit").click(function(){let e=$(this).closest(".win-item"),i=e.find("input.bid-id").val(),n=e.find(".reviewAuction-"+i);if(isNaN(i))return;let o=$("#win-review-form-"+i),t=o.find(".win-review-rating-stars").children(".glyphicon-star").length,s=o.find("#reviewComment-"+i).val(),a=o.parent(),r=$.ajax({type:"POST",url:BASE_URL+"api/user/review_auction.php",data:{rating:t,message:s,bidId:i,userId:userId,token:token},dataType:"json"});r.done(function(e,i,o){let t=e.message;e.response.includes("Success")&&(a.fadeOut(500,function(){a.remove()}),n.fadeOut(500,function(){n.remove()})),$.magnificPopup.open({items:{src:'<div class="white-popup">'+t+"</div>",type:"inline",mainClass:"mfp-fade"}})}),r.fail(function(e,i,n){console.error("The following error occurred: "+i+": "+n)})}),$(".closePopup").on("click",function(){$.magnificPopup.close()});let o=$(".notificationsPage .notifications-wrapper");o.on("click",".readNotification",function(){let e=$(this).attr("class").split("id-");if(2===e.length){let i=$(this).closest(".notifications-wrapper"),n=e[1],o=$.ajax({type:"POST",url:BASE_URL+"api/user/read_notification.php",data:{notification:n,token:token,userId:userId},dataType:"json"});o.done(function(e,n,o){let t=e.message;e.response.includes("Success")?($('<a href="#" data-toggle="tooltip" title="Notification read!"><i class="fa fa-eye" aria-hidden="true"></i></a>').insertAfter(i.find(".media-body small")),i.find("span a.readNotification").remove()):$.magnificPopup.open({items:{src:'<div class="white-popup">'+t+"</div>",type:"inline",mainClass:"mfp-fade"}})})}}),o.on("click",".removeNotificationPopup",function(){let i=$(this).attr("class").split("id-");if(2===i.length){let n=$(this).closest(".notifications-wrapper"),o=i[1];$(".removeNotificationPopup").magnificPopup({type:"inline",midClick:!0,mainClass:"mfp-fade"}).magnificPopup("open"),$(".removeNotification").off(),$(".removeNotification").one("click",function(){$.magnificPopup.close(),e(o,n)})}}),$(".reportUserPopup").magnificPopup({type:"inline",midClick:!0,mainClass:"mfp-fade"}),$("#reportUserForm").validate({rules:{reportUserMessage:{required:!0,maxlength:512}},submitHandler:i})});