$(document).ready(function(){function e(e,i){$.magnificPopup.close();let o;(o=$.ajax({type:"POST",url:BASE_URL+"api/user/delete_notification.php",data:{id:e,token:token,userId:userId},dataType:"text"})).done(function(e,o,t){$.magnificPopup.open({items:{src:'<div class="white-popup">'+e+"</div>",type:"inline"}}),e.includes("Success")&&(n=$(".notificationsPage .notifications-wrapper"),i.hide("slow",function(){i.remove()}),1===n.length&&(window.location.href=window.location.href))}),o.fail(function(e,i,o){console.error("The following error occurred: "+i,o)})}function i(e){$.magnificPopup.close();let i=$("#reportUserMessage").val(),o=$(e).find("input[name=reportedUserId]").val(),n=$.ajax({type:"POST",url:BASE_URL+"api/user/report_user.php",data:{reportedUserId:o,comment:i,userId:userId,token:token}});n.done(function(i,o,n){i.includes("Success")&&$(e).trigger("reset"),$.magnificPopup.open({items:{src:'<div class="white-popup">'+i+"</div>",type:"inline"}})}),n.fail(function(e,i,o){console.error("The following error occurred: "+i+": "+o)})}if($(window).width()<=768){let e=$("#wins");e.find(".win-wrapper").removeClass("col-lg-3").removeClass("col-md-3"),e.find(".win-wrapper #win-info-image").addClass("col-sm-6"),e.find(".win-wrapper #win-info-text").addClass("col-sm-6"),e.find(".win-info").removeClass("text-right").addClass("text-center"),e.find(".win-image").width(156)}$(".clock").each(function(){let e=$(this).find("p").text();$(this).countdown(e).on("update.countdown",function(e){let i="%Hh:%Mm:%Ss";e.offset.totalDays>0&&(i="%-d day%!d "+i),e.offset.weeks>0&&(i="%-w week%!w "+i),$(this).html(e.strftime(i))}).on("finish.countdown",function(e){$(this).html("This offer has expired!").parent().addClass("disabled")})});let o=document.location.hash;o&&$('.nav-tabs a[href="'+o+'"]').tab("show"),$(".nav-tabs a").on("shown.bs.tab",function(e){window.location.hash=e.target.hash}),$("#follow-btn").click(function(){let e,i=$("#details").find(".details-short-info-member-number").text();"Follow"===$(this).text()?((e=$.ajax({type:"POST",url:BASE_URL+"api/user/follow.php",data:{followedUserId:i,userId:userId,token:token}})).done(function(e,i,o){e.includes("Success")&&$("#follow-btn").html("Unfollow")}),e.fail(function(e,i,o){console.error("The following error occurred: "+i+": "+o)})):((e=$.ajax({type:"POST",url:BASE_URL+"api/user/unfollow.php",data:{unfollowedUserId:i,userId:userId,token:token}})).done(function(e,i,o){e.includes("Success")&&$("#follow-btn").html("Follow")}),e.fail(function(e,i,o){console.error("The following error occurred: "+i+": "+o)}))}),$("#following").find(".btn").click(function(){let e=$(this).parent().prev().children("a").eq(0).attr("href"),i=e.lastIndexOf("id="),o=e.substring(i+3),n=$(this).parent().parent(),t=$.ajax({type:"POST",url:BASE_URL+"api/user/unfollow.php",data:{unfollowedUserId:o,userId:userId,token:token}});t.done(function(e,i,o){console.info("Response: "+e),e.includes("Success")&&n.fadeOut(500,function(){n.remove();let e=$(".following-badge"),i=e.html();e.html(parseInt(i,10)-1);let o=$("#following");0===o.children().length&&o.html("<p>No users being followed.</p>")})}),t.fail(function(e,i,o){console.error("The following error occurred: "+i+": "+o)})}),$("#wins").find(".win-review-rating-stars .glyphicon").mouseover(function(){$(this).removeClass("glyphicon-star-empty").addClass("glyphicon-star"),$(this).prevAll().removeClass("glyphicon-star-empty").addClass("glyphicon-star"),$(this).nextAll().removeClass("glyphicon-star").addClass("glyphicon-star-empty")}),$(".btn-review-submit").click(function(){let e=$(this).prev().prev().children(".win-review-rating-stars").children(".glyphicon-star").length,i=$(this).prev().children("textarea").val(),o=$(this).prev().prev().prev().val(),n=$(this).parent().parent(),t=$.ajax({type:"POST",url:BASE_URL+"api/user/review_auction.php",data:{rating:e,message:i,bidId:o,userId:userId,token:token}});t.done(function(e,i,o){console.info("Insert review response: "+e),e.includes("Success")&&n.fadeOut(500,function(){n.remove()})}),t.fail(function(e,i,o){console.error("The following error occurred: "+i+": "+o)})}),$(".closePopup").on("click",function(){$.magnificPopup.close()});let n=$(".notificationsPage .notifications-wrapper");n.on("click",".readNotification",function(){let e=$(this).attr("class").split("id-");if(2===e.length){let i=$(this).closest(".notifications-wrapper"),o=e[1],n=$.ajax({type:"POST",url:BASE_URL+"api/user/read_notification.php",data:{notification:o,token:token,userId:userId}});n.done(function(e,o,n){e.includes("Success")?($('<a href="#" data-toggle="tooltip" title="Notification read!"><i class="fa fa-eye" aria-hidden="true"></i></a>').insertAfter(i.find(".media-body small")),i.find("span a.readNotification").remove()):$.magnificPopup.open({items:{src:'<div class="white-popup">'+e+"</div>",type:"inline"}})})}}),n.on("click",".removeNotificationPopup",function(){let i=$(this).attr("class").split("id-");if(2===i.length){let o=$(this).closest(".notifications-wrapper"),n=i[1];$(".removeNotificationPopup").magnificPopup({type:"inline",midClick:!0,mainClass:"mfp-fade"}).magnificPopup("open"),$(".removeNotification").off(),$(".removeNotification").one("click",function(){$.magnificPopup.close(),e(n,o)})}}),$(".reportUserPopup").magnificPopup({type:"inline",midClick:!0,mainClass:"mfp-fade"}),$("#reportUserForm").validate({rules:{reportUserMessage:{required:!0,maxlength:512}},submitHandler:i})});