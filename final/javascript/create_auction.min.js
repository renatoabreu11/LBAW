$(document).ready(function(){$("input[type=radio][name=optradio]").change(function(){"api"===this.value?$("#amazonSearch").fadeIn("slow"):"personalized"===this.value&&($("#amazonSearch").fadeOut("slow"),$("#ASIN").val(""))}),$("#amazonSearch").on("change","#keyword",function(){$(this).css("border","")}),$("#amazonSearch").on("click","td.selectAmazonItem",function(){let e=$(this),t=e.siblings("td.productASIN").html().trim(),a=e.siblings("td.productTitle").html().trim();$("#ASIN").val(t),$("#product_name").val(a),$.ajax({type:"GET",url:BASE_URL+"api/auction/amazon_lookup.php",dataType:"json",data:{ASIN:t},success:function(e){let t=e.message;if(e.response.includes("Success")){$("#description").val(e.description);let t=e.attributes,a=$("#characteristics");a.empty();for(let e of t){let t="<option>"+e+"</option>";a.append(t)}a.selectpicker("refresh")}else $.magnificPopup.open({items:{src:'<div class="white-popup">'+t+"</div>",type:"inline",mainClass:"mfp-fade"}})},error:function(e){console.log(e)}})}),$("#amazonSearch").on("click",".searchAmazon",function(e){e.stopPropagation();let t=$("#keyword").val();if(""==t)return void $("#keyword").css("border","1px solid red");let a=$("#search_index").val();$(this).prop("disabled",!0),$.ajax({type:"GET",url:BASE_URL+"api/auction/amazon_search.php",dataType:"json",data:{keyword:t,category:a},success:function(e){e.message;if(e.response.includes("Success")){let t=$("#amazonSearch");t.empty(),t.append(e.amazonDiv),t.show()}$(this).prop("disabled",!1)},error:function(e){console.log(e),$(this).prop("disabled",!1)}})}),$("#step-1").on("click",".input-group span.addCharacteristic",function(){let e=$(this).closest(".input-group").find("input[name=newCharacteristic]"),t=e.val();if(!(""===t||t.length>128)){let a=$("#characteristics"),i="<option>"+t+"</option>";a.append(i),a.selectpicker("refresh"),e.val("")}}),$(function(){$("#startDatePicker").datetimepicker({minDate:moment(),defaultDate:moment(),locale:"pt"}),$("#endDatePicker").datetimepicker({minDate:moment().add(15,"minutes"),defaultDate:moment().add(15,"minutes"),locale:"pt",useCurrent:!1}),$("#startDatePicker").on("dp.change",function(e){$("#endDatePicker").data("DateTimePicker").minDate(e.date)}),$("#endDatePicker").on("dp.change",function(e){$("#startDatePicker").data("DateTimePicker").maxDate(e.date)})}),$.validator.addMethod("productCategoriesSelected",function(e,t,a){return e.length>0&&e.length<3},"At least one category must be selected."),$.validator.addMethod("auctionTypeSelected",function(e,t,a){return""!==e&&("Sealed Bid"===e||"Default"===e||"Dutch"===e)},"The auction type must be selected"),$("#createAuctionForm").validate({rules:{product_name:{required:!0,maxlength:64},quantity:{required:!0,digits:!0},condition:{required:!0,maxlength:512},"category[]":{productCategoriesSelected:!0},base_price:{required:!0,digits:!0},start_date:{required:!0},end_date:{required:!0},auction_type:{auctionTypeSelected:!0}},messages:{product_name:{required:"Please, enter the product name.",maxlength:"The product name must be no more than 64 characters."},quantity:{required:"Please, enter the number of products that are up to sell.",digits:"Only digits are allowed."},base_price:{required:"Please, enter the auction initial price.",digits:"Only digits are allowed."},condition:{required:"Please, enter the product condition.",maxlength:"The product condition must be no more than 512 characters."},category:{productCategoriesSelected:"Please, select a category."},auction_type:{auctionTypeSelected:"Please, select the auction type."}},errorPlacement:function(e,t){if("description"===$(t).attr("name")||"condition"===$(t).attr("name"))e.insertAfter(t);else{let a=$(t).closest(".input-group");e.insertAfter(a)}}});let e=$("ul.setup-panel li a"),t=$(".setup-content");t.hide(),e.click(function(a){a.preventDefault();let i=$($(this).attr("href")),n=$(this).closest("li");n.hasClass("disabled")||(e.closest("li").removeClass("active"),n.addClass("active"),t.hide(),i.show())}),$("ul.setup-panel li.active a").trigger("click"),$("#activate-step-2").on("click",function(){$("#product_name").valid()&&$("#category").valid()&&$("#description").valid()&&$("#condition").valid()&&($("ul.setup-panel li:eq(1)").removeClass("disabled"),$('ul.setup-panel li a[href="#step-2"]').trigger("click"),$(this).remove())}),$("#activate-step-3").on("click",function(e){$("#end_date").valid()&&$("#start_date").valid()&&$("#auction_type").valid()&&$("#base_price").valid()&&($("#createAuction-btn").removeClass("hidden"),$("ul.setup-panel li:eq(2)").removeClass("disabled"),$('ul.setup-panel li a[href="#step-3"]').trigger("click"),$(this).remove())})});